У меня не найдётся слов, чтобы описать, насколько ужасно это решение. Суффиксный массив.
